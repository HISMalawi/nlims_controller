# frozen_string_literal: true

puts 'Initiating update...'
sending_facility_districts = Speciman.where("created_at > '2023-09-11' AND district IS NOT NULL")
                                     .group('sending_facility, district').select('DISTINCT sending_facility, district')

sending_facility_districts.each do |send_facility_district|
  puts "Updating district for ==> #{send_facility_district.sending_facility}"
  Speciman.where("sending_facility = '#{send_facility_district.sending_facility}'
  AND district IS NULL AND created_at > '2024-01-01'").update_all(district: send_facility_district.district)
end

fix_site_names = [
  { sending_facility: 'Chileka Health Centre', district: 'Lilongwe', new_name: 'Chileka Health Centre (Lilongwe)' },
  { sending_facility: 'Chileka (Lilongwe) Health Center', district: 'Lilongwe',
    new_name: 'Chileka Health Centre (Lilongwe)' },
  { sending_facility: 'Area 18 Health Center', district: 'Lilongwe', new_name: 'Area 18 Urban Health Centre' },
  { sending_facility: 'Area 18 Health Centre', district: 'Lilongwe', new_name: 'Area 18 Urban Health Centre' },
  { sending_facility: 'Area 25 Health Centre', district: 'Lilongwe', new_name: 'Area 25 Urban Health Centre' },
  { sending_facility: 'Area30 Police Dispensary', district: 'Lilongwe', new_name: 'Police (Area 30) Dispensary' },
  { sending_facility: 'Police Area 30 Dispensary', district: 'Lilongwe', new_name: 'Police (Area 30) Dispensary' },
  { sending_facility: 'Bangwe Health Center', district: 'Blantyre', new_name: 'Bangwe Health Centre' },
  { sending_facility: 'Bwaila Hospital Martin Preuss Centre', district: 'Lilongwe', new_name: 'Martin Preuss Centre' },
  { sending_facility: 'Chitedze Health Center', district: 'Lilongwe', new_name: 'Chitedze Health Centre' },
  { sending_facility: 'David Livingstone Memorial Clinic', district: 'Lilongwe',
    new_name: 'DGM Livingstonia Hospital' },
  { sending_facility: 'Alinafe Rehab Centre', district: 'Nkhotakota', new_name: 'Alinafe Rehabilitation Centre' },
  { sending_facility: 'Chitedze Health Center', district: 'Lilongwe', new_name: 'Chitedze Health Centre' },
  { sending_facility: 'Chitera Health Center', district: 'Chiradzulu', new_name: 'Chitera Health Centre' },
  { sending_facility: 'Ekwendeni Mission Hospital', district: 'Mzimba', new_name: 'Ekwendeni Hospital' },
  { sending_facility: 'Gateway Clinic', district: 'Blantyre', new_name: 'Gateway Clinic (Blantyre)' },
  { sending_facility: 'Kamuzu (KCH) Central Hospital', district: 'Lilongwe', new_name: 'Kamuzu Central Hospital' },
  { sending_facility: 'Kamuzu Barracks', district: 'Lilongwe', new_name: 'Kamuzu Barracks Dispensary' },
  { sending_facility: 'Kawale Health Center', district: 'Lilongwe', new_name: 'Kawale Urban Health Centre' },
  { sending_facility: 'Kawale Health Centre', district: 'Lilongwe', new_name: 'Kawale Urban Health Centre' },
  { sending_facility: 'Khombedza Health Center', district: 'Salima', new_name: 'Khombedza Health Centre' },
  { sending_facility: 'Lifeline Health Center', district: 'Salima', new_name: 'Life Line Salima Health Centre' },
  { sending_facility: 'Lilongwe Lighthouse', district: '', new_name: 'Lighthouse' },
  { sending_facility: 'Lilongwe Lighthouse', district: 'Lilongwe', new_name: 'Lighthouse' },
  { sending_facility: 'Koche Community Hospital', district: 'Lilongwe', new_name: 'Koche Health Centre' },
  { sending_facility: 'Macro Blantyre', district: 'Blantyre', new_name: 'MACRO Blantyre' },
  { sending_facility: 'Macro Mzuzu', district: 'Mzimba', new_name: 'MACRO Mzuzu' },
  { sending_facility: 'MACRO Mzuzu', district: 'Unknown', new_name: 'MACRO Mzuzu' },
  { sending_facility: 'Macro Mzuzu', district: 'Mzuzu', new_name: 'MACRO Mzuzu' },
  { sending_facility: 'Mafco Health Center', district: 'Salima', new_name: 'Mafco Health Centre' },
  { sending_facility: 'Malingunde Health Center', district: 'Lilongwe', new_name: 'Malingunde Health Centre' },
  { sending_facility: 'Mangochi Hospital District', district: 'Mangochi', new_name: 'Mangochi District Hospital' },
  { sending_facility: 'Matawale Health Centre', district: 'Zomba', new_name: 'Matawale Urban Health Centre' },
  { sending_facility: 'MAULA PRISON HEALTH CENTER', district: 'Lilongwe', new_name: 'Maula Prison Health Centre' },
  { sending_facility: 'Mbulumbudzi Health Center', district: 'Chiradzulu', new_name: 'Mbulumbudzi Health Centre' }
]
fix_site_names.each do |fix_site_name|
  puts "Updating district for ==> #{fix_site_name.sending_facility}"
end
facilities = [
  { sending_facility: 'DAEYANG ST LUKE', district: 'Blantyre' },
  { sending_facility: 'Admarc Dispensary', district: 'Kasungu' },
  { sending_facility: 'Adventist Health Center', district: 'Lilongwe' },
  { sending_facility: 'Adventist Health Centre (Lilongwe)', district: 'Lilongwe' },
  { sending_facility: 'Adventist Hospital (Blantyre)', district: 'Blantyre' },
  { sending_facility: 'Airwing Clinic (Lilongwe)', district: 'Liilongwe' },
  { sending_facility: 'Alinafe Community Hospital', district: 'Nkhotakota' },
  { sending_facility: 'Alinafe Rehabilitation Centre', district: 'Nkhotakota' },
  { sending_facility: 'Amalika Health Centre', district: 'Thyolo' },
  { sending_facility: 'Area 18 Urban Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Area 25 Urban Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Balaka District Hospital', district: 'Balaka' },
  { sending_facility: 'Bangwe Health Centre', district: 'Blantyre' },
  { sending_facility: 'Baylor Childrens Foundation Malawi', district: 'Lilongwe' },
  { sending_facility: 'Bilal Dispensary', district: 'Chiradzulu' },
  { sending_facility: 'Bilira Health Centre', district: 'Ntcheu' },
  { sending_facility: 'Bimbi Health Centre', district: 'Zomba' },
  { sending_facility: 'Blantyre Health District', district: 'Blantyre' },
  { sending_facility: 'Bolero Rural Health Centre', district: 'Rumphi' },
  { sending_facility: 'Bolero Rural Hospital', district: 'Rumphi' },
  { sending_facility: 'Bvumbwe Research Health Centre', district: 'Thyolo' },
  { sending_facility: 'Bwaila Hospital', district: 'Lilongwe' },
  { sending_facility: 'Bwanje Health Centre', district: '' },
  { sending_facility: 'Chamba Health Centre (Zomba)', district: 'Zomba' },
  { sending_facility: 'Changalume Barracks Clinic', district: 'Zomba' },
  { sending_facility: 'Chikwawa District Health Office', district: 'Chikwawa' },
  { sending_facility: 'Chikwawa District Hospital', district: 'Chikwawa' },
  { sending_facility: 'Chikwawa District Hospital Laboratory', district: 'Chikwawa' },
  { sending_facility: 'Chikweo Health Centre', district: 'Machinga' },
  { sending_facility: 'Chileka Health Centre', district: 'Blantyre' },
  { sending_facility: 'Chileka Health Centre (Lilongwe)', district: 'Lilongwe' },
  { sending_facility: 'Chileka Health Centrey', district: '' },

  { sending_facility: 'Chileka SDA Health Center', district: 'Blantyre' },
  { sending_facility: 'Chileka SDQ Health Centre (Blantyre)', district: '' },
  { sending_facility: 'Chilimba City Clinic', district: 'Blantyre' },
  { sending_facility: 'Chilipa Health Centre (Mangochi)', district: 'Mangochi' },
  { sending_facility: 'Chilipa Health Centre (Zomba)', district: 'Zomba' },
  { sending_facility: 'Chilomoni Health Center', district: 'Blantyre' },
  { sending_facility: 'Chilumba Rural Hospital', district: 'Karonga' },
  { sending_facility: 'Chimvu Health Centre', district: 'Thyolo' },
  { sending_facility: 'Chingale Health Centre', district: 'Zomba' },
  { sending_facility: 'Chinguluwe (Salima) Health Center', district: 'Salima' },
  { sending_facility: 'Chinyama Health Centre', district: 'Mulanje' },
  { sending_facility: 'Chipini Health Centre', district: 'Zomba' },
  { sending_facility: 'Chipoka Health Center', district: 'Salima' },
  { sending_facility: 'Chiponde Health Centre', district: 'Mangochi' },
  { sending_facility: 'Chiradzulu District Hospital', district: 'Chiradzulu' },
  { sending_facility: 'Chiradzulu District Hospital Laboratory', district: 'Chiradzulu' },
  { sending_facility: 'Chirimba Heath Centre', district: 'Blantyre' },
  { sending_facility: 'Chisitu Health Centre', district: 'Mulanje' },
  { sending_facility: 'Chisoka Health Centre', district: 'Thyolo' },
  { sending_facility: 'Chitedze Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Chitekesa Health Centre', district: 'Phalombe' },
  { sending_facility: 'Chitera Health Centre', district: 'Chiradzulu' },
  { sending_facility: 'Chitipa District Hospital', district: 'Chitipa' },
  { sending_facility: 'Chizumulo (St Marys) Health Center', district: 'Likoma' },
  { sending_facility: 'Chonde Health Centre', district: 'Mulanje' },
  { sending_facility: 'Chonde Lab', district: 'Mulanje' },
  { sending_facility: 'City Clinic (Zomba)', district: 'Zomba' },
  { sending_facility: 'Cobbe Barracks Hospital', district: 'Zomba' },
  { sending_facility: 'Daeyang Luke Hospital', district: 'Lilongwe' },
  { sending_facility: 'Dedza District Hospital', district: 'Dedza' },
  { sending_facility: 'Dedza District Hospital Laboratory', district: 'Dedza' },
  { sending_facility: 'DGM Livingstonia Hospital', district: 'Rumphi' },
  { sending_facility: 'Domasi Rural Hospital', district: 'Zomba' },
  { sending_facility: 'Dowa District Hospital', district: 'Dowa' },
  { sending_facility: 'Dzenza Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Dzenza Mission Hospital', district: 'Lilongwe' },
  { sending_facility: 'Ekwendeni Hospital', district: 'Mzimba' },
  { sending_facility: 'Embangweni Hospital', district: 'Mzimba' },
  { sending_facility: 'Engucwini Dispensary', district: 'Rumphi' },
  { sending_facility: 'Euthini Rural Hospital', district: 'Mzimba' },
  { sending_facility: 'Gateway Clinic (Blantyre)', district: 'Blantyre' },
  { sending_facility: 'Guillime Mission Hospital', district: 'Mchinji' },
  { sending_facility: 'Jalasi Health Centre', district: 'Mangochi' },
  { sending_facility: 'Jenda Health Centre', district: 'Mzimba' },
  { sending_facility: 'Kabudula Rural Hospital', district: 'Lilongwe' },
  { sending_facility: 'Kachere Health Center', district: 'Nkhata bay' },
  { sending_facility: 'Kachere Private Clinic (Area 23)', district: 'Lilongwe' },
  { sending_facility: 'Kalinde Health Centre (Phalombe)', district: 'Phalombe' },
  { sending_facility: 'Kalulu Health Centre', district: 'Chikwawa' },
  { sending_facility: 'Kambenje Health Centre', district: 'Mulanje' },
  { sending_facility: 'Kamuzu Barracks Dispensary', district: 'Lilongwe' },
  { sending_facility: 'Kamuzu Barracks Hospital Laboratory', district: 'Lilongwe' },
  { sending_facility: 'Kamuzu Central Hospital', district: 'Lilongwe' },
  { sending_facility: 'Kamuzu Central Hospital Laboratory', district: 'Lilongwe' },
  { sending_facility: 'Kamwe Health Centre', district: 'Rumphi' },
  { sending_facility: 'Kaphuka Health Centre', district: 'Dedza' },

  { sending_facility: 'Kapiri Health Centre', district: 'Mchinji' },
  { sending_facility: 'Kapiri Health Centre', district: 'Nkhotakota' },
  { sending_facility: 'Kapiri Mission Hospital', district: '' },
  { sending_facility: 'Kapiri Mission Hospital', district: 'Lilongwe' },

  { sending_facility: 'Kaporo Rural Hospital', district: 'Karonga' },
  { sending_facility: 'KARONGA DISTRICT HOSPITAL', district: 'Karonga' },
  { sending_facility: 'Karonga District Hospital', district: 'Karonga' },
  { sending_facility: 'Kasinje Health Centre', district: 'Ntheu' },
  { sending_facility: 'Kasungu District Hospital', district: 'Kasungu' },
  { sending_facility: 'kATAWA HEALTH CENTRE', district: 'Salima' },
  { sending_facility: 'Katema Health Centre', district: 'Mangochi' },
  { sending_facility: 'Kawale Urban Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Khombedza Health Centre', district: 'Salima' },
  { sending_facility: 'Khonjeni Health Centre', district: 'Thyolo' },
  { sending_facility: 'Koche Health Centre', district: 'Mangochi' },
  { sending_facility: 'Kochilira Hospital', district: 'Mchinji' },
  { sending_facility: 'Life Line Salima Health Centre', district: 'Salima' },
  { sending_facility: 'Lifuwu Health Center', district: 'Salima' },
  { sending_facility: 'Lighthouse', district: 'Lilongwe' },
  { sending_facility: 'Lighthouse KCH', district: 'Lilongwe' },
  { sending_facility: 'Likangala Health Centre', district: 'Zomba' },
  { sending_facility: 'Likuni Hospital', district: 'Lilongwe' },
  { sending_facility: 'Limbe Health Centre', district: 'Blantyre' },
  { sending_facility: 'Lizulu Health Centre', district: 'Ntcheu' },
  { sending_facility: 'Lobi Rural Health Centre', district: 'Dedza' },
  { sending_facility: 'Lumbadzi Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Lundu Health Centre', district: 'Blantyre' },
  { sending_facility: 'Lungwena Health Centre', district: 'Mangochi' },

  { sending_facility: 'Lunjika Health Centre', district: '' },

  { sending_facility: 'Lunzu BLM Clinic', district: 'Blantyre' },
  { sending_facility: 'Machinga District Hospital', district: 'Machinga' },
  { sending_facility: 'Machinjiri Health Centre', district: 'Blantyre' },
  { sending_facility: 'MACRO Blantyre', district: 'Blantyre' },
  { sending_facility: 'MACRO Mzuzu', district: 'Mzimba' },
  { sending_facility: 'Madisi Mission Hospital', district: 'Dowa' },
  { sending_facility: 'Madziabango Health Center', district: 'Blantyre' },
  { sending_facility: 'Mafco Health Centre', district: 'Salima' },
  { sending_facility: 'Makanjira Health Centre', district: 'Mangochi' },
  { sending_facility: 'Makata Health Centre (Lunzu)', district: 'Blantyre' },
  { sending_facility: 'Makheta Youth Organization Clinic', district: 'Blantyre' },
  { sending_facility: 'Makhwira Health Centre', district: 'Chikwawa' },
  { sending_facility: 'Makiyoni Health Center', district: 'Salima' },
  { sending_facility: 'Makwapala Health Centre', district: 'Zomba' },
  { sending_facility: 'Malabada Health Centre', district: 'Blantyre' },
  { sending_facility: 'Malamulo Adventist Hospital Laboratory', district: 'Thyolo' },
  { sending_facility: 'Malamulo Hospital', district: 'Thyolo' },
  { sending_facility: 'Malingunde Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Mangamba Dispensary', district: 'Machinga' },
  { sending_facility: 'Mangochi District Hospital', district: 'Mangochi' },
  { sending_facility: 'Mangunda Maternity', district: 'Thyolo' },
  { sending_facility: 'Martin Preuss Centre', district: 'Lilongwe' },
  { sending_facility: 'Masenjere Health Centre', district: 'Nsanje' },
  { sending_facility: 'Matawale Urban Health Centre', district: 'Zomba' },
  { sending_facility: 'Matiki Health Centre', district: 'Nkhotakota' },
  { sending_facility: 'Matiya Health Centre', district: 'Zomba' },
  { sending_facility: 'Maula Prison Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Mauwa Health Centre', district: 'Chiradzulu' },
  { sending_facility: 'Mayaka Health Centre', district: 'Zomba' },
  { sending_facility: 'Mbabvi Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Mbayani Health Centre', district: 'Blantyre' },

  { sending_facility: 'Mbenje Health Centre', district: 'Mulanje' },
  { sending_facility: 'Mbiza Health Centre', district: 'Mulanje' },
  { sending_facility: 'Mbulumbudzi Health Centre', district: 'Chiradzulu' },
  { sending_facility: 'Mchinji District Hospital', district: 'Mchinji' },
  { sending_facility: 'Mdeka Health Center', district: 'Blantyre' },
  { sending_facility: 'Mehboob Clinic', district: 'Mangochi' },
  { sending_facility: 'Mfera Health Centre', district: 'Chikwawa' },
  { sending_facility: 'Migowi Health Centre', district: 'Phalombe' },
  { sending_facility: 'Mikolongwe Health Centre', district: '' },
  { sending_facility: 'Milepa Health Centre', district: 'Chiradzulu' },
  { sending_facility: 'Milonde Health Centre', district: '' },
  { sending_facility: 'Mitundeu Health Centre', district: '' },
  { sending_facility: 'Mitundeu Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Mitundu Hospital', district: 'Lilongwe' },
  { sending_facility: 'Mitundu Rural Hospital', district: '' },
  { sending_facility: 'Mitundu Rural Hospital', district: 'Lilongwe' },
  { sending_facility: 'Mkhwayi Health Centre', district: '' },
  { sending_facility: 'Mlale Mission Hospital', district: '' },
  { sending_facility: 'Mlambe Hospital', district: '' },
  { sending_facility: 'Mlambe Hospital', district: 'Blantyre' },
  { sending_facility: 'Mmambo Health Centre (Zomba)', district: '' },
  { sending_facility: 'Monkey-Bay Health Centre', district: '' },
  { sending_facility: 'Monkey-Bay Health Centre', district: 'Mangochi' },
  { sending_facility: 'MonkeyBay Community Hospital Laboratory', district: '' },
  { sending_facility: 'MonkeyBay Community Hospital Laboratory', district: 'Lilongwe' },
  { sending_facility: 'Moyale Barracks Health Centre', district: '' },
  { sending_facility: 'Moyale Barracks Health Centre', district: 'Mzimba North' },
  { sending_facility: 'Moyale Barracks Health Centre', district: 'Unknown' },
  { sending_facility: 'Moyo Clinic (Lilongwe)', district: '' },
  { sending_facility: 'Moyo Clinic (Lilongwe)', district: 'Lilongwe' },
  { sending_facility: 'Mpala Health Centre', district: '' },
  { sending_facility: 'Mpasa Health Centre', district: 'Phalombe' },
  { sending_facility: 'Mpemba Health Centre', district: '' },
  { sending_facility: 'Mpemba Health Centre', district: 'Blantyre' },
  { sending_facility: 'Mpemba Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Mpherembe Health Centre', district: 'Mzimba' },
  { sending_facility: 'Mponela Health Centre', district: '' },
  { sending_facility: 'Mponela Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Mponela Rural Hospital', district: '' },
  { sending_facility: 'Mponela Rural Hospital', district: 'Ntchisi' },
  { sending_facility: 'Mposa Health Centre', district: '' },
  { sending_facility: 'Mtenthera Health Centre', district: '' },
  { sending_facility: 'Mua Mission Hospital', district: '' },
  { sending_facility: 'Mua Mission Hospital', district: 'Lilongwe' },
  { sending_facility: 'Mulanje District Hospital', district: '' },
  { sending_facility: 'Mulanje District Hospital', district: 'Mulanje' },
  { sending_facility: 'Mulanje District Hospital Laboratory', district: '' },
  { sending_facility: 'Mulanje District Hospital Laboratory', district: 'Mulanje' },
  { sending_facility: 'Mulanje Mission Hospital', district: '' },
  { sending_facility: 'Mulanje Mission Hospital', district: 'Mulanje' },
  { sending_facility: 'Mulibwanji Health Centre (Mangochi)', district: '' },
  { sending_facility: 'Mulibwanji Health Centre (Mangochi)', district: 'Mangochi' },
  { sending_facility: 'Muloza Health Centre', district: '' },
  { sending_facility: 'Mvera Army Camp Dispensary', district: 'Dowa' },
  { sending_facility: 'Mwanga Health Centre', district: '' },
  { sending_facility: 'Mwanga Health Centre', district: 'Phalombe' },
  { sending_facility: 'Mwanza District Hospital', district: '' },
  { sending_facility: 'Mwanza District Hospital', district: 'Mwanza' },
  { sending_facility: 'Mzimba District Hospital', district: '' },
  { sending_facility: 'Mzimba District Hospital', district: 'Mzimba' },
  { sending_facility: 'Mzimba District Hospital', district: 'Mzimba South' },
  { sending_facility: 'Mzimba District Hospital Laboratory', district: '' },
  { sending_facility: 'Mzimba District Hospital Laboratory', district: 'Mzimba' },
  { sending_facility: 'Mziza Health Centre (Kasungu)', district: '' },
  { sending_facility: 'Mzuzu Central Hospital', district: '' },
  { sending_facility: 'Mzuzu Central Hospital', district: 'Mzimba' },
  { sending_facility: 'Mzuzu Central Hospital', district: 'Mzimba North' },
  { sending_facility: 'Mzuzu Central Hospital Laboratory', district: 'Mzuzu' },
  { sending_facility: 'Mzuzu Urban Health Centre', district: '' },
  { sending_facility: 'Mzuzu Urban Health Centre', district: 'Mzimba' },
  { sending_facility: 'Mzuzu Urban Health Centre', district: 'Mzimba North' },
  { sending_facility: 'Namadzi Health Centre', district: '' },
  { sending_facility: 'Namalaka Health Centre', district: '' },
  { sending_facility: 'Namasalima Health Centre', district: '' },
  { sending_facility: 'Namasalima Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Namasalima Health Centre', district: 'Mulanje' },
  { sending_facility: 'Namasalima Health Centre (Mulanje)', district: '' },
  { sending_facility: 'Namasalima Health Centre (Mulanje)', district: 'Mulanje' },
  { sending_facility: 'Namasalima Health Centre (Zomba)', district: '' },
  { sending_facility: 'Nambazo Health Centre', district: '' },
  { sending_facility: 'Namdumbo Health Centre', district: '' },
  { sending_facility: 'Namikango Health Centre', district: '' },
  { sending_facility: 'Namitambo Health Center', district: 'Chiradzulu' },
  { sending_facility: 'Namitambo Health Centre', district: '' },
  { sending_facility: 'Namitambo Health Centre', district: 'Chiradzulu' },
  { sending_facility: 'Namitambo Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Nathenje Health Centre', district: '' },
  { sending_facility: 'Nathenje Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Nazombe Health Centre (Gogo Nazombe)', district: '' },
  { sending_facility: 'Ndamera Health Centre', district: '' },
  { sending_facility: 'Ndirande Health Center', district: 'Blantyre' },
  { sending_facility: 'Ndirande Health Centre', district: '' },
  { sending_facility: 'Ndirande Health Centre', district: 'Blantyre' },
  { sending_facility: 'Ndirande Urban Health Centre', district: '' },
  { sending_facility: 'Ndirande Urban Health Centre', district: 'Blantyre' },
  { sending_facility: 'Ndunde Health Centre', district: '' },
  { sending_facility: 'Ngabu SDA Health Centre', district: 'Neno' },
  { sending_facility: 'Nguludi Hospital', district: 'Chiradzulu' },
  { sending_facility: 'Nguludi St Joseph Hospital', district: '' },
  { sending_facility: 'Nguludi St Josephs Hospital', district: '' },
  { sending_facility: 'Nguludi St Josephs Hospital', district: 'Chiradzulu' },
  { sending_facility: 'Ngwelero Health Centre', district: '' },
  { sending_facility: 'Ngwelero Health Centre', district: 'Zomba' },
  { sending_facility: 'Njuyu Health Centre', district: 'Mzimba' },
  { sending_facility: 'Nkalo Health Centre', district: '' },
  { sending_facility: 'Nkhata Bay District Hospital', district: '' },
  { sending_facility: 'Nkhoma Hospital', district: '' },
  { sending_facility: 'Nkhoma Hospital', district: 'Lilongwe' },
  { sending_facility: 'Nkhoma Mission Hospital', district: '' },
  { sending_facility: 'Nkhoma Mission Hospital', district: 'Lilongwe' },
  { sending_facility: 'Nkhorongo Health Centre', district: 'Mzimba' },
  { sending_facility: 'Nkhotakota District Hospital', district: '' },
  { sending_facility: 'Nkhotakota District Hospital', district: 'Nkhotakota' },
  { sending_facility: 'Nkhunga Health Centre', district: '' },
  { sending_facility: 'Nkhwazi Health Centre', district: '' },
  { sending_facility: 'Nkope Health Centre', district: '' },
  { sending_facility: 'Nsanje District Hospital', district: '' },
  { sending_facility: 'Nsanje District Hospital', district: 'Nsanje' },
  { sending_facility: 'Nsanje District Hospital Laboratory', district: '' },
  { sending_facility: 'Nsanje District Hospital Laboratory', district: 'Lilongwe' },
  { sending_facility: 'Nsanje District Hospital Laboratory', district: 'Nsanje' },
  { sending_facility: 'Nsaru Health Center', district: 'Lilongwe' },
  { sending_facility: 'Nsaru Health Centre', district: '' },
  { sending_facility: 'Nsiyaludzu Health Centre', district: '' },
  { sending_facility: 'Nsiyaludzu Health Centre', district: 'Ntcheu' },
  { sending_facility: 'Ntaja Health Centre', district: '' },
  { sending_facility: 'Ntcheu District Hospital', district: '' },
  { sending_facility: 'Ntcheu District Hospital', district: 'Ntcheu' },
  { sending_facility: 'Ntcheu District Hospital Laboratory', district: '' },
  { sending_facility: 'Ntcheu District Hospital Laboratory', district: 'Lilongwe' },
  { sending_facility: 'Ntchisi District Hospital', district: '' },
  { sending_facility: 'Ntchisi District Hospital', district: 'Ntchisi' },
  { sending_facility: 'Nyungwe Health Centre', district: '' },
  { sending_facility: 'Our Lady of Mount Carmel Community Hospital', district: '' },
  { sending_facility: 'Our Lady of Mount Carmel Community Hospital', district: 'Mchinji' },
  { sending_facility: 'Parachute Health Centre', district: 'Salima' },
  { sending_facility: 'Phalombe District Hospital', district: '' },
  { sending_facility: 'Phalombe Health Centre Laboratory', district: '' },
  { sending_facility: 'Phalombe Health Centre Laboratory', district: 'Phalombe' },
  { sending_facility: 'Phalombe Health District', district: '' },
  { sending_facility: 'Phalombe Mission Hospital', district: '' },
  { sending_facility: 'Phalula Health Centre', district: '' },
  { sending_facility: 'Pirimiti Health Centre', district: '' },
  { sending_facility: 'Pirimiti Health Centre', district: 'Zomba' },
  { sending_facility: 'Police (Area 30) Dispensary', district: '' },
  { sending_facility: 'Police (Area 30) Dispensary', district: 'Lilongwe' },
  { sending_facility: 'Police Area 30 Dispensary', district: 'Lilongwe' },
  { sending_facility: 'Queen Elizabeth (QECH) Central Hospital', district: 'Blantyre' },
  { sending_facility: 'Queen Elizabeth Central Hospital', district: 'Blantyre' },
  { sending_facility: 'Queen Elizabeth Central Hospital Laboratory', district: 'Blantyre' },
  { sending_facility: 'Rumphi District Hospital', district: 'Rumphi' },
  { sending_facility: 'Rumphi District Hospital Laboratory', district: 'Rumphi' },
  { sending_facility: 'Salima District Hospital', district: 'Salima' },
  { sending_facility: 'Salima District Hospital', district: 'Unknown' },
  { sending_facility: 'Senga Bay Baptist Dispensary', district: 'Salima' },
  { sending_facility: 'Soche Health Center', district: 'Blantyre' },
  { sending_facility: 'South Lunzu Health Center', district: 'Lilongwe' },
  { sending_facility: 'South Lunzu Health Centre', district: 'Blantyre' },
  { sending_facility: 'St Gabriels Hospital', district: 'Lilongwe' },
  { sending_facility: 'St Johns Mission Hospital', district: 'Mzimba' },
  { sending_facility: 'St Lukes Hospital', district: 'Zomba' },
  { sending_facility: 'St Lukes Mission Hospital', district: 'Lilongwe' },
  { sending_facility: 'St Martin Hospital', district: 'Mangochi' },
  { sending_facility: 'St Montfort', district: 'Lilongwe' },
  { sending_facility: 'St Montfort Hospital', district: 'Chikwawa' },
  { sending_facility: 'St Vincent Clinic', district: 'Blantyre' },
  { sending_facility: 'SUCOMA Health Centre (Illovo)', district: 'Chikwawa' },
  { sending_facility: 'Sucoma Health Centre (ILLOVO)', district: 'Lilongwe' },
  { sending_facility: 'Thondwe Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Thunga Health Centre', district: 'Thyolo' },
  { sending_facility: 'Thyolo District Hospital', district: 'Thyolo' },
  { sending_facility: 'Thyolo District Hospital Laboratory', district: 'Thyolo' },
  { sending_facility: 'Tisungane Clinic Zomba Lighthouse', district: 'Zomba' },
  { sending_facility: 'Umodzi Family Centre', district: 'Blantyre' },
  { sending_facility: 'Zingwangwa Health Center', district: 'Blantyre' },
  { sending_facility: 'Zomba Central Hospital', district: 'Lilongwe' },
  { sending_facility: 'Zomba Central Hospital', district: 'Zomba' },
  { sending_facility: 'Police (Area 30) Dispensary', district: '' },
  { sending_facility: 'Police (Area 30) Dispensary', district: 'Lilongwe' },
  { sending_facility: 'Police Area 30 Dispensary', district: 'Lilongwe' },
  { sending_facility: 'Queen Elizabeth (QECH) Central Hospital', district: 'Blantyre' },
  { sending_facility: 'Queen Elizabeth Central Hospital', district: '' },
  { sending_facility: 'Queen Elizabeth Central Hospital', district: 'Blantyre' },
  { sending_facility: 'Queen Elizabeth Central Hospital Laboratory', district: 'Blantyre' },
  { sending_facility: 'Registration', district: '' },
  { sending_facility: 'Rumphi District Hospital', district: '' },
  { sending_facility: 'Rumphi District Hospital', district: 'Rumphi' },
  { sending_facility: 'Rumphi District Hospital Laboratory', district: 'Rumphi' },
  { sending_facility: 'Sadzi Health Centre', district: '' },
  { sending_facility: 'Salima District Hospital', district: '' },
  { sending_facility: 'Salima District Hospital', district: 'Salima' },
  { sending_facility: 'Salima District Hospital', district: 'Unknown' },
  { sending_facility: 'Senga Bay Baptist Dispensary', district: '' },
  { sending_facility: 'Senga Bay Baptist Dispensary', district: 'Salima' },
  { sending_facility: 'Sister Teleza Health Centre', district: '' },
  { sending_facility: 'Sister Teleza Hospital Laboratory', district: '' },
  { sending_facility: 'Soche Health Center', district: 'Blantyre' },
  { sending_facility: 'Soche Maternity', district: '' },
  { sending_facility: 'Sorgin Health Centre', district: '' },
  { sending_facility: 'South Lunzu Health Center', district: '' },
  { sending_facility: 'South Lunzu Health Center', district: 'Lilongwe' },
  { sending_facility: 'South Lunzu Health Centre', district: '' },
  { sending_facility: 'South Lunzu Health Centre', district: 'Blantyre' },
  { sending_facility: 'St Gabriels Hospital', district: '' },
  { sending_facility: 'St Gabriels Hospital', district: 'Lilongwe' },
  { sending_facility: 'St Johns Mission Hospital', district: 'Mzimba' },
  { sending_facility: 'St Johns Mzuzu Hospital', district: '' },
  { sending_facility: 'St Lukes Hospital', district: '' },
  { sending_facility: 'St Lukes Hospital', district: 'Zomba' },
  { sending_facility: 'St Lukes Mission Hospital', district: '' },
  { sending_facility: 'St Lukes Mission Hospital', district: 'Lilongwe' },
  { sending_facility: 'St Martin Hospital', district: '' },
  { sending_facility: 'St Martin Hospital', district: 'Mangochi' },
  { sending_facility: 'St Montfort', district: '' },
  { sending_facility: 'St Montfort', district: 'Lilongwe' },
  { sending_facility: 'St Montfort Hospital', district: '' },
  { sending_facility: 'St Montfort Hospital', district: 'Chikwawa' },
  { sending_facility: 'St Vincent Clinic', district: 'Blantyre' },
  { sending_facility: 'St Vincent Health Centre (Chadzunda)', district: '' },
  { sending_facility: 'SUCOMA Health Centre (Illovo)', district: '' },
  { sending_facility: 'SUCOMA Health Centre (Illovo)', district: 'Chikwawa' },
  { sending_facility: 'Sucoma Health Centre (ILLOVO)', district: 'Lilongwe' },
  { sending_facility: 'Sukasanje Health Centre', district: '' },
  { sending_facility: 'Thekerani Rural Hospital', district: '' },
  { sending_facility: 'Thondwe Health Centre', district: '' },
  { sending_facility: 'Thondwe Health Centre', district: 'Lilongwe' },
  { sending_facility: 'Thuchila Health Centre', district: '' },
  { sending_facility: 'Thumbwe Health Centre', district: '' },
  { sending_facility: 'Thunga Health Centre', district: '' },
  { sending_facility: 'Thunga Health Centre', district: 'Thyolo' },
  { sending_facility: 'Thyolo District Hospital', district: '' },
  { sending_facility: 'Thyolo District Hospital', district: 'Thyolo' },
  { sending_facility: 'Thyolo District Hospital Laboratory', district: '' },
  { sending_facility: 'Thyolo District Hospital Laboratory', district: 'Thyolo' },
  { sending_facility: 'Tisungane Clinic Zomba Lighthouse', district: 'Zomba' },
  { sending_facility: 'Trinity - Fatima Hospital', district: '' },
  { sending_facility: 'Trinity Fatima Hospital', district: '' },
  { sending_facility: 'Umodzi Family Centre', district: '' },
  { sending_facility: 'Umodzi Family Centre', district: 'Blantyre' },
  { sending_facility: 'Zingwangwa Health Center', district: 'Blantyre' },
  { sending_facility: 'Zingwangwa Urban Health Centre', district: '' },
  { sending_facility: 'Zomba Central Hospital', district: '' },
  { sending_facility: 'Zomba Central Hospital', district: 'Lilongwe' },
  { sending_facility: 'Zomba Central Hospital', district: 'Zomba' },
  { sending_facility: 'Zomba Central Hospital Laboratory', district: '' }
]
facilities.each do |send_facility_district|
  puts "Updating district for ==> #{send_facility_district[:sending_facility]}"
  Speciman.where("sending_facility = '#{send_facility_district[:sending_facility]}'
    AND district IS NULL AND created_at > '2024-01-01'").update_all(district: send_facility_district[:district])
end
puts 'Updating districts done'
